#!/usr/bin/bash
# Archive files

# Usage display
if [ $# -eq 0 -o "$1" = -h -o "$1" = --help ]; then
  echo "${0##*/} <file1> <*dir>... - archive files, folders..."
  exit 1
fi

# File(s) existence test
for file in "$@"; do
  [ ! -e "$file" ] && echo "Non-exist: "$file"." && error=y
done
[ "$error" ] && exit 1

# Archive name prompt
read -p "Archive name extension-less [archive]: " arc_nme
if [ ! "$arc_nme" ]; then
  arc_nme=archive
fi

# Archive type
if ! hash xz 2>&-; then
  arc_ext=.tar.gz
else
  arc_ext=.tar.xz
fi

# Archive existence test
if [ -f "$arc_nme""$arc_ext" ]; then
  echo "Existant: "$arc_nme""$arc_ext""
  exit 1
fi

# Archive creation
if ! hash xz 2>&-; then
  tar -czf "$arc_nme".tar.gz "$@" && \
  echo "Archive created: "$arc_nme""$arc_ext""
else
  tar -cJf "$arc_nme".tar.xz "$@" && \
  echo "Archive created: "$arc_nme""$arc_ext""
fi
